#include "ShaderCommon.h"

float4 main(PSInput input) : SV_Target
{
	float4 vResult = float4(0,0,0,0);

	[unroll]
	for (int i=0;i<POINT_LIGHTS_MAX;++i)
	{
		float3 vDir = normalize(g_PointLights[i].vPos.xyz - input.vWorldPos.xyz);
		float fDiffuse = max(0, dot(normalize(input.vNorm), vDir));
		vResult += fDiffuse * g_PointLights[i].vColor * g_PointLights[i].vPos.w;
	}

	
	return clamp(vResult, 0, 1);
}
